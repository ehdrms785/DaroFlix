{"ast":null,"code":"import _taggedTemplateLiteral from\"D:\\\\Documents\\\\React\\\\DaroFlix\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/taggedTemplateLiteral\";import _regeneratorRuntime from\"D:\\\\Documents\\\\React\\\\DaroFlix\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _toConsumableArray from\"D:\\\\Documents\\\\React\\\\DaroFlix\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"D:\\\\Documents\\\\React\\\\DaroFlix\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"D:\\\\Documents\\\\React\\\\DaroFlix\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"D:\\\\Documents\\\\React\\\\DaroFlix\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _assertThisInitialized from\"D:\\\\Documents\\\\React\\\\DaroFlix\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _createSuper from\"D:\\\\Documents\\\\React\\\\DaroFlix\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import _inherits from\"D:\\\\Documents\\\\React\\\\DaroFlix\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";function _templateObject4(){var data=_taggedTemplateLiteral([\"\\n  font-size: 18px;\\n  text-align: center;\\n  display: block;\\n  line-height: 1.5;\\n  margin-top: 10px;\\n\"]);_templateObject4=function _templateObject4(){return data;};return data;}function _templateObject3(){var data=_taggedTemplateLiteral([\"\\n  width: 200px;\\n  height: 250px;\\n  display: block;\\n  margin-top: 20px;\\n\"]);_templateObject3=function _templateObject3(){return data;};return data;}function _templateObject2(){var data=_taggedTemplateLiteral([\"\\n  margin: auto;\\n\"]);_templateObject2=function _templateObject2(){return data;};return data;}function _templateObject(){var data=_taggedTemplateLiteral([\"\\n  height: 90%;\\n  margin-bottom: 25px;\\n  overflow-y: scroll;\\n  display: grid;\\n  grid-template-columns: repeat(auto-fill, 200px);\\n  grid-gap: 40px;\\n  justify-content: center;\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import React from\"react\";import styled from\"styled-components\";import{movieApi}from\"../../api\";import{Link}from\"react-router-dom\";var TabSimilar=/*#__PURE__*/function(_React$Component){_inherits(TabSimilar,_React$Component);var _super=_createSuper(TabSimilar);function TabSimilar(props){var _this;_classCallCheck(this,TabSimilar);_this=_super.call(this,props);_this.state={movie_results:null,scroll:false,page:2};_this.infiniteScroll=_this.infiniteScroll.bind(_assertThisInitialized(_this));return _this;}_createClass(TabSimilar,[{key:\"getDataMore\",value:function(){var _getDataMore=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this$state,movie_results,scroll,page,movie_id,new_movies,_yield$movieApi$getSi,movies;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this$state=this.state,movie_results=_this$state.movie_results,scroll=_this$state.scroll,page=_this$state.page;movie_id=this.props.movie_id;// const { recommends_ } = this.props;\nconsole.log(\"getDataMore\");_context.prev=3;if(!scroll){_context.next=11;break;}new_movies=[];_context.next=8;return movieApi.getSimilarMovies(movie_id,page);case 8:_yield$movieApi$getSi=_context.sent;new_movies=_yield$movieApi$getSi.data.results;// new_movies가 있을때만 업데이트\nif(new_movies.length>0){movies=[].concat(_toConsumableArray(movie_results),_toConsumableArray(new_movies));this.setState(function(current){return{movie_results:movies,scroll:false,page:current.page+1};});}case 11:_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](3);this.setState({error:\"Can not find Similar Data from API\"});case 16:_context.prev=16;this.setState({loading:false});return _context.finish(16);case 19:case\"end\":return _context.stop();}}},_callee,this,[[3,13,16,19]]);}));function getDataMore(){return _getDataMore.apply(this,arguments);}return getDataMore;}()},{key:\"infiniteScroll\",value:function infiniteScroll(e){var target=e.target;var clientHeight=target.clientHeight,scrollHeight=target.scrollHeight,scrollTop=target.scrollTop;var scroll=this.state.scroll;// console.log(`Scroll Top : ${scrollTop}`);\n// console.log(`clientHieght: ${clientHeight}`);\n// console.log(`scrollHeight: ${scrollHeight}`);\nif(scrollTop+clientHeight>=scrollHeight-500){if(scroll===false){this.setState({scroll:true});this.getDataMore();}}}},{key:\"componentDidUpdate\",value:function componentDidUpdate(){document.getElementById(\"Movie_result\").addEventListener(\"scroll\",this.infiniteScroll.bind(this));}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){document.getElementById(\"Movie_result\").removeEventListener(\"scroll\",this.infiniteScroll);}},{key:\"componentDidMount\",value:function componentDidMount(){this.setState({movie_results:this.props.recommends_result});// window.addEventListener(\"scroll\", this.infiniteScroll);\n// document.addEventListener(\"scroll\", this.infiniteScroll.bind(this));\n// document\n//   .getElementsByClassName(\"Movie_result\")\n//   .addEventListner(\"scroll\", this.infiniteScroll);\n}},{key:\"render\",value:function render(){var movie_results=this.state.movie_results;return/*#__PURE__*/React.createElement(Container,{id:\"Movie_result\"},movie_results&&movie_results.map(function(movie){return/*#__PURE__*/React.createElement(Link,{to:\"/movie/\".concat(movie.id)},/*#__PURE__*/React.createElement(MovieContainer,null,/*#__PURE__*/React.createElement(Cover,{src:movie.backdrop_path?\"https://image.tmdb.org/t/p/w500\".concat(movie.backdrop_path):require(\"../../assets/NoPoster.jpg\")}),/*#__PURE__*/React.createElement(Title,null,movie.title.length>17?\"\".concat(movie.title.substring(0,17),\" ...\"):movie.title)));}));}}]);return TabSimilar;}(React.Component);export{TabSimilar as default};var Container=styled.div(_templateObject());var MovieContainer=styled.div(_templateObject2());var Cover=styled.img(_templateObject3());var Title=styled.span(_templateObject4());","map":{"version":3,"sources":["D:/Documents/React/DaroFlix/src/Components/DetailTab/TabSimilar.js"],"names":["React","styled","movieApi","Link","TabSimilar","props","state","movie_results","scroll","page","infiniteScroll","bind","movie_id","console","log","new_movies","getSimilarMovies","data","results","length","movies","setState","current","error","loading","e","target","clientHeight","scrollHeight","scrollTop","getDataMore","document","getElementById","addEventListener","removeEventListener","recommends_result","map","movie","id","backdrop_path","require","title","substring","Component","Container","div","MovieContainer","Cover","img","Title","span"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { movieApi } from \"../../api\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nexport default class TabSimilar extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      movie_results: null,\r\n      scroll: false,\r\n      page: 2,\r\n    };\r\n    this.infiniteScroll = this.infiniteScroll.bind(this);\r\n  }\r\n\r\n  async getDataMore() {\r\n    const { movie_results, scroll, page } = this.state;\r\n    const { movie_id } = this.props;\r\n    // const { recommends_ } = this.props;\r\n    console.log(\"getDataMore\");\r\n\r\n    try {\r\n      if (scroll) {\r\n        let new_movies = [];\r\n        ({\r\n          data: { results: new_movies },\r\n        } = await movieApi.getSimilarMovies(movie_id, page));\r\n\r\n        // new_movies가 있을때만 업데이트\r\n        if (new_movies.length > 0) {\r\n          const movies = [...movie_results, ...new_movies];\r\n          this.setState((current) => ({\r\n            movie_results: movies,\r\n            scroll: false,\r\n            page: current.page + 1,\r\n          }));\r\n        }\r\n      }\r\n    } catch (e) {\r\n      this.setState({ error: \"Can not find Similar Data from API\" });\r\n    } finally {\r\n      this.setState({ loading: false });\r\n    }\r\n  }\r\n  infiniteScroll(e) {\r\n    let target = e.target;\r\n\r\n    const { clientHeight, scrollHeight, scrollTop } = target;\r\n    const { scroll } = this.state;\r\n\r\n    // console.log(`Scroll Top : ${scrollTop}`);\r\n    // console.log(`clientHieght: ${clientHeight}`);\r\n    // console.log(`scrollHeight: ${scrollHeight}`);\r\n    if (scrollTop + clientHeight >= scrollHeight - 500) {\r\n      if (scroll === false) {\r\n        this.setState({ scroll: true });\r\n        this.getDataMore();\r\n      }\r\n    }\r\n  }\r\n  componentDidUpdate() {\r\n    document\r\n      .getElementById(\"Movie_result\")\r\n      .addEventListener(\"scroll\", this.infiniteScroll.bind(this));\r\n  }\r\n  componentWillUnmount() {\r\n    document\r\n      .getElementById(\"Movie_result\")\r\n      .removeEventListener(\"scroll\", this.infiniteScroll);\r\n  }\r\n  componentDidMount() {\r\n    this.setState({\r\n      movie_results: this.props.recommends_result,\r\n    });\r\n    // window.addEventListener(\"scroll\", this.infiniteScroll);\r\n    // document.addEventListener(\"scroll\", this.infiniteScroll.bind(this));\r\n    // document\r\n    //   .getElementsByClassName(\"Movie_result\")\r\n    //   .addEventListner(\"scroll\", this.infiniteScroll);\r\n  }\r\n  render() {\r\n    const { movie_results } = this.state;\r\n    return (\r\n      <Container id=\"Movie_result\">\r\n        {movie_results &&\r\n          movie_results.map((movie) => (\r\n            <Link to={`/movie/${movie.id}`}>\r\n              <MovieContainer>\r\n                <Cover\r\n                  src={\r\n                    movie.backdrop_path\r\n                      ? `https://image.tmdb.org/t/p/w500${movie.backdrop_path}`\r\n                      : require(\"../../assets/NoPoster.jpg\")\r\n                  }\r\n                ></Cover>\r\n                <Title>\r\n                  {movie.title.length > 17\r\n                    ? `${movie.title.substring(0, 17)} ...`\r\n                    : movie.title}\r\n                </Title>\r\n              </MovieContainer>\r\n            </Link>\r\n          ))}\r\n      </Container>\r\n    );\r\n  }\r\n}\r\n\r\nconst Container = styled.div`\r\n  height: 90%;\r\n  margin-bottom: 25px;\r\n  overflow-y: scroll;\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fill, 200px);\r\n  grid-gap: 40px;\r\n  justify-content: center;\r\n`;\r\nconst MovieContainer = styled.div`\r\n  margin: auto;\r\n`;\r\nconst Cover = styled.img`\r\n  width: 200px;\r\n  height: 250px;\r\n  display: block;\r\n  margin-top: 20px;\r\n`;\r\nconst Title = styled.span`\r\n  font-size: 18px;\r\n  text-align: center;\r\n  display: block;\r\n  line-height: 1.5;\r\n  margin-top: 10px;\r\n`;\r\n"]},"metadata":{},"sourceType":"module"}