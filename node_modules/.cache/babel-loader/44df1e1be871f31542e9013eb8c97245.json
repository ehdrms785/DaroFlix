{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\Documents\\\\React\\\\DaroFlix\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"D:\\\\Documents\\\\React\\\\DaroFlix\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"D:\\\\Documents\\\\React\\\\DaroFlix\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"D:\\\\Documents\\\\React\\\\DaroFlix\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _createSuper from\"D:\\\\Documents\\\\React\\\\DaroFlix\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import _inherits from\"D:\\\\Documents\\\\React\\\\DaroFlix\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React from\"react\";import DetailPresenter from\"./DetailPresenter\";import{movieApi,tvApi}from\"../../api\";var _default=/*#__PURE__*/function(_React$Component){_inherits(_default,_React$Component);var _super=_createSuper(_default);function _default(props){var _this;_classCallCheck(this,_default);_this=_super.call(this,props);_this.getData=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this$props,id,push,isMovie,parsedIntId,result,casts_result,recommends_result,_yield$movieApi$movie,_yield$movieApi$getCa,_yield$movieApi$getSi,_yield$tvApi$showDeta,_yield$tvApi$getCasts;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this$props=_this.props,id=_this$props.match.params.id,push=_this$props.history.push;isMovie=_this.state.isMovie;parsedIntId=parseInt(id);if(!isNaN(parsedIntId)){_context.next=5;break;}return _context.abrupt(\"return\",push(\"/\"));case 5:result=null;casts_result=null;recommends_result=null;_context.prev=8;if(!isMovie){_context.next=24;break;}_context.next=12;return movieApi.movieDetail(parsedIntId);case 12:_yield$movieApi$movie=_context.sent;result=_yield$movieApi$movie.data;_context.next=16;return movieApi.getCasts(parsedIntId);case 16:_yield$movieApi$getCa=_context.sent;casts_result=_yield$movieApi$getCa.data.cast;_context.next=20;return movieApi.getSimilarMovies(parsedIntId,1);case 20:_yield$movieApi$getSi=_context.sent;recommends_result=_yield$movieApi$getSi.data.results;_context.next=32;break;case 24:_context.next=26;return tvApi.showDetail(parsedIntId);case 26:_yield$tvApi$showDeta=_context.sent;result=_yield$tvApi$showDeta.data;_context.next=30;return tvApi.getCasts(parsedIntId);case 30:_yield$tvApi$getCasts=_context.sent;casts_result=_yield$tvApi$getCasts.data.cast;case 32:_context.next=37;break;case 34:_context.prev=34;_context.t0=_context[\"catch\"](8);// If api couldn't get data\n// 임시로\n// return push(\"/\");\n_this.setState({error:\"Can not find anything\"});case 37:_context.prev=37;_this.setState({loading:false,result:result,casts_result:casts_result,recommends_result:recommends_result});return _context.finish(37);case 40:case\"end\":return _context.stop();}}},_callee,null,[[8,34,37,40]]);}));_this.changeParam=function(id){var push=_this.props.history.push;push(\"/movie/\".concat(id));};var pathname=props.location.pathname;_this.state={result:null,casts_result:null,recommends_result:null,error:null,loading:true,isMovie:pathname.includes(\"/movie/\"),modal:false,modalType:null};return _this;}_createClass(_default,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:// console.log(this.props);\nthis.getData();case 1:case\"end\":return _context2.stop();}}},_callee2,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){var prevId=prevProps.match.params.id;var nowId=this.props.match.params.id;// console.log(prevId, nowId);\nif(prevId!==nowId){this.getData();}}},{key:\"render\",value:function render(){var _this$state=this.state,result=_this$state.result,casts_result=_this$state.casts_result,recommends_result=_this$state.recommends_result,error=_this$state.error,loading=_this$state.loading,isMovie=_this$state.isMovie;return/*#__PURE__*/React.createElement(DetailPresenter,{result:result,casts_result:casts_result,recommends_result:recommends_result,error:error,loading:loading,isMovie:isMovie,changeParam:this.changeParam,handleOpenModal:this.handleOpenModal,handleCloseModal:this.handleCloseModal});}}]);return _default;}(React.Component);export{_default as default};","map":{"version":3,"sources":["D:/Documents/React/DaroFlix/src/Routes/Detail/DetailContainer.js"],"names":["React","DetailPresenter","movieApi","tvApi","props","getData","id","match","params","push","history","isMovie","state","parsedIntId","parseInt","isNaN","result","casts_result","recommends_result","movieDetail","data","getCasts","cast","getSimilarMovies","results","showDetail","setState","error","loading","changeParam","pathname","location","includes","modal","modalType","prevProps","prevId","nowId","handleOpenModal","handleCloseModal","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport DetailPresenter from \"./DetailPresenter\";\r\nimport { movieApi, tvApi } from \"../../api\";\r\n\r\nexport default class extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    const {\r\n      location: { pathname },\r\n    } = props;\r\n\r\n    this.state = {\r\n      result: null,\r\n      casts_result: null,\r\n      recommends_result: null,\r\n      error: null,\r\n      loading: true,\r\n      isMovie: pathname.includes(\"/movie/\"),\r\n      modal: false,\r\n      modalType: null,\r\n    };\r\n  }\r\n\r\n  async componentDidMount() {\r\n    // console.log(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    const {\r\n      match: {\r\n        params: { id: prevId },\r\n      },\r\n    } = prevProps;\r\n    const {\r\n      match: {\r\n        params: { id: nowId },\r\n      },\r\n    } = this.props;\r\n    // console.log(prevId, nowId);\r\n    if (prevId !== nowId) {\r\n      this.getData();\r\n    }\r\n  }\r\n  getData = async () => {\r\n    const {\r\n      match: {\r\n        params: { id },\r\n      },\r\n      history: { push },\r\n    } = this.props;\r\n\r\n    const { isMovie } = this.state;\r\n    const parsedIntId = parseInt(id);\r\n    if (isNaN(parsedIntId)) {\r\n      return push(\"/\");\r\n    }\r\n    let result = null;\r\n    let casts_result = null;\r\n    let recommends_result = null;\r\n    try {\r\n      if (isMovie) {\r\n        ({ data: result } = await movieApi.movieDetail(parsedIntId));\r\n        ({\r\n          data: { cast: casts_result },\r\n        } = await movieApi.getCasts(parsedIntId));\r\n        ({\r\n          data: { results: recommends_result },\r\n        } = await movieApi.getSimilarMovies(parsedIntId, 1));\r\n      } else {\r\n        ({ data: result } = await tvApi.showDetail(parsedIntId));\r\n        ({\r\n          data: { cast: casts_result },\r\n        } = await tvApi.getCasts(parsedIntId));\r\n      }\r\n    } catch {\r\n      // If api couldn't get data\r\n      // 임시로\r\n      // return push(\"/\");\r\n      this.setState({ error: \"Can not find anything\" });\r\n    } finally {\r\n      this.setState({\r\n        loading: false,\r\n        result,\r\n        casts_result,\r\n        recommends_result,\r\n      });\r\n    }\r\n  };\r\n  changeParam = (id) => {\r\n    const {\r\n      history: { push },\r\n    } = this.props;\r\n    push(`/movie/${id}`);\r\n  };\r\n\r\n  render() {\r\n    const {\r\n      result,\r\n      casts_result,\r\n      recommends_result,\r\n      error,\r\n      loading,\r\n      isMovie,\r\n    } = this.state;\r\n    return (\r\n      <DetailPresenter\r\n        result={result}\r\n        casts_result={casts_result}\r\n        recommends_result={recommends_result}\r\n        error={error}\r\n        loading={loading}\r\n        isMovie={isMovie}\r\n        changeParam={this.changeParam}\r\n        handleOpenModal={this.handleOpenModal}\r\n        handleCloseModal={this.handleCloseModal}\r\n      />\r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}