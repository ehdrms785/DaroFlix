{"ast":null,"code":"var _jsxFileName = \"D:\\\\Documents\\\\React\\\\DaroFlix\\\\src\\\\Components\\\\DetailTab\\\\TabSimilar.js\";\nimport React from \"react\";\nimport styled from \"styled-components\";\nimport { movieApi } from \"../../api\";\nimport { Link } from \"react-router-dom\";\nexport default class TabSimilar extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      movie_results: null,\n      scroll: false,\n      page: 2\n    };\n    this.infiniteScroll = this.infiniteScroll.bind(this);\n  }\n\n  async getDataMore() {\n    const {\n      movie_results,\n      scroll,\n      page\n    } = this.state;\n    const {\n      movie_id\n    } = this.props; // const { recommends_ } = this.props;\n\n    console.log(\"getDataMore\");\n\n    try {\n      if (scroll) {\n        let new_movies = [];\n        ({\n          data: {\n            results: new_movies\n          }\n        } = await movieApi.getSimilarMovies(movie_id, page)); // new_movies가 있을때만 업데이트\n\n        if (new_movies.length > 0) {\n          const movies = [...movie_results, ...new_movies];\n          this.setState(current => ({\n            movie_results: movies,\n            scroll: false,\n            page: current.page + 1\n          }));\n        }\n      }\n    } catch (e) {\n      this.setState({\n        error: \"Can not find Similar Data from API\"\n      });\n    } finally {\n      this.setState({\n        loading: false\n      });\n    }\n  }\n\n  infiniteScroll(e) {\n    let target = e.target;\n    const {\n      clientHeight,\n      scrollHeight,\n      scrollTop\n    } = target;\n    const {\n      scroll\n    } = this.state; // console.log(`Scroll Top : ${scrollTop}`);\n    // console.log(`clientHieght: ${clientHeight}`);\n    // console.log(`scrollHeight: ${scrollHeight}`);\n\n    if (scrollTop + clientHeight >= scrollHeight - 500) {\n      if (scroll === false) {\n        this.setState({\n          scroll: true\n        });\n        this.getDataMore();\n      }\n    }\n  }\n\n  componentDidUpdate() {\n    console.log(\"I am TabSimilar Did Update!\");\n    document.getElementById(\"Movie_result\").addEventListener(\"scroll\", this.infiniteScroll.bind(this));\n  }\n\n  componentWillUnmount() {\n    document.getElementById(\"Movie_result\").removeEventListener(\"scroll\", this.infiniteScroll);\n  }\n\n  componentDidMount() {\n    console.log(\"I am TabSimailr Did Mount !!\");\n    this.setState({\n      movie_results: this.props.recommends_result\n    }); // window.addEventListener(\"scroll\", this.infiniteScroll);\n    // document.addEventListener(\"scroll\", this.infiniteScroll.bind(this));\n    // document\n    //   .getElementsByClassName(\"Movie_result\")\n    //   .addEventListner(\"scroll\", this.infiniteScroll);\n  }\n\n  render() {\n    const {\n      movie_results\n    } = this.state;\n    console.log(\"TabSimilar_render ~~\");\n    console.log(movie_results);\n    return /*#__PURE__*/React.createElement(Container, {\n      id: \"Movie_result\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 7\n      }\n    }, movie_results && movie_results.map(movie => /*#__PURE__*/React.createElement(Link, {\n      to: `/movie/${movie.id}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(MovieContainer, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Cover, {\n      src: movie.backdrop_path ? `https://image.tmdb.org/t/p/w500${movie.backdrop_path}` : require(\"../../assets/NoPoster.jpg\"),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(Title, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 17\n      }\n    }, movie.title.length > 17 ? `${movie.title.substring(0, 17)} ...` : movie.title)))));\n  }\n\n}\nconst Container = styled.div`\n  height: 90%;\n  margin-bottom: 25px;\n  overflow-y: scroll;\n  display: grid;\n  grid-template-columns: repeat(auto-fill, 200px);\n  grid-gap: 20px;\n  margin-left: 15px;\n`;\nconst MovieContainer = styled.div`\n  margin: auto;\n`;\nconst Cover = styled.img`\n  width: 200px;\n  height: 250px;\n  display: block;\n  margin-top: 20px;\n`;\nconst Title = styled.span`\n  font-size: 18px;\n  text-align: center;\n  display: block;\n  line-height: 1.5;\n  margin-top: 10px;\n`;","map":{"version":3,"sources":["D:/Documents/React/DaroFlix/src/Components/DetailTab/TabSimilar.js"],"names":["React","styled","movieApi","Link","TabSimilar","Component","constructor","props","state","movie_results","scroll","page","infiniteScroll","bind","getDataMore","movie_id","console","log","new_movies","data","results","getSimilarMovies","length","movies","setState","current","e","error","loading","target","clientHeight","scrollHeight","scrollTop","componentDidUpdate","document","getElementById","addEventListener","componentWillUnmount","removeEventListener","componentDidMount","recommends_result","render","map","movie","id","backdrop_path","require","title","substring","Container","div","MovieContainer","Cover","img","Title","span"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { movieApi } from \"../../api\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nexport default class TabSimilar extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      movie_results: null,\r\n      scroll: false,\r\n      page: 2,\r\n    };\r\n    this.infiniteScroll = this.infiniteScroll.bind(this);\r\n  }\r\n\r\n  async getDataMore() {\r\n    const { movie_results, scroll, page } = this.state;\r\n    const { movie_id } = this.props;\r\n    // const { recommends_ } = this.props;\r\n    console.log(\"getDataMore\");\r\n\r\n    try {\r\n      if (scroll) {\r\n        let new_movies = [];\r\n        ({\r\n          data: { results: new_movies },\r\n        } = await movieApi.getSimilarMovies(movie_id, page));\r\n\r\n        // new_movies가 있을때만 업데이트\r\n        if (new_movies.length > 0) {\r\n          const movies = [...movie_results, ...new_movies];\r\n          this.setState((current) => ({\r\n            movie_results: movies,\r\n            scroll: false,\r\n            page: current.page + 1,\r\n          }));\r\n        }\r\n      }\r\n    } catch (e) {\r\n      this.setState({ error: \"Can not find Similar Data from API\" });\r\n    } finally {\r\n      this.setState({ loading: false });\r\n    }\r\n  }\r\n  infiniteScroll(e) {\r\n    let target = e.target;\r\n\r\n    const { clientHeight, scrollHeight, scrollTop } = target;\r\n    const { scroll } = this.state;\r\n\r\n    // console.log(`Scroll Top : ${scrollTop}`);\r\n    // console.log(`clientHieght: ${clientHeight}`);\r\n    // console.log(`scrollHeight: ${scrollHeight}`);\r\n    if (scrollTop + clientHeight >= scrollHeight - 500) {\r\n      if (scroll === false) {\r\n        this.setState({ scroll: true });\r\n        this.getDataMore();\r\n      }\r\n    }\r\n  }\r\n  componentDidUpdate() {\r\n    console.log(\"I am TabSimilar Did Update!\");\r\n    document\r\n      .getElementById(\"Movie_result\")\r\n      .addEventListener(\"scroll\", this.infiniteScroll.bind(this));\r\n  }\r\n  componentWillUnmount() {\r\n    document\r\n      .getElementById(\"Movie_result\")\r\n      .removeEventListener(\"scroll\", this.infiniteScroll);\r\n  }\r\n  componentDidMount() {\r\n    console.log(\"I am TabSimailr Did Mount !!\");\r\n    this.setState({\r\n      movie_results: this.props.recommends_result,\r\n    });\r\n    // window.addEventListener(\"scroll\", this.infiniteScroll);\r\n    // document.addEventListener(\"scroll\", this.infiniteScroll.bind(this));\r\n    // document\r\n    //   .getElementsByClassName(\"Movie_result\")\r\n    //   .addEventListner(\"scroll\", this.infiniteScroll);\r\n  }\r\n  render() {\r\n    const { movie_results } = this.state;\r\n    console.log(\"TabSimilar_render ~~\");\r\n    console.log(movie_results);\r\n    return (\r\n      <Container id=\"Movie_result\">\r\n        {movie_results &&\r\n          movie_results.map((movie) => (\r\n            <Link to={`/movie/${movie.id}`}>\r\n              <MovieContainer>\r\n                <Cover\r\n                  src={\r\n                    movie.backdrop_path\r\n                      ? `https://image.tmdb.org/t/p/w500${movie.backdrop_path}`\r\n                      : require(\"../../assets/NoPoster.jpg\")\r\n                  }\r\n                ></Cover>\r\n                <Title>\r\n                  {movie.title.length > 17\r\n                    ? `${movie.title.substring(0, 17)} ...`\r\n                    : movie.title}\r\n                </Title>\r\n              </MovieContainer>\r\n            </Link>\r\n          ))}\r\n      </Container>\r\n    );\r\n  }\r\n}\r\n\r\nconst Container = styled.div`\r\n  height: 90%;\r\n  margin-bottom: 25px;\r\n  overflow-y: scroll;\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fill, 200px);\r\n  grid-gap: 20px;\r\n  margin-left: 15px;\r\n`;\r\nconst MovieContainer = styled.div`\r\n  margin: auto;\r\n`;\r\nconst Cover = styled.img`\r\n  width: 200px;\r\n  height: 250px;\r\n  display: block;\r\n  margin-top: 20px;\r\n`;\r\nconst Title = styled.span`\r\n  font-size: 18px;\r\n  text-align: center;\r\n  display: block;\r\n  line-height: 1.5;\r\n  margin-top: 10px;\r\n`;\r\n"]},"metadata":{},"sourceType":"module"}