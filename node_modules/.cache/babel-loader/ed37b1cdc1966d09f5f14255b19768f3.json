{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\Documents\\\\React\\\\DaroFlix\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"D:\\\\Documents\\\\React\\\\DaroFlix\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"D:\\\\Documents\\\\React\\\\DaroFlix\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"D:\\\\Documents\\\\React\\\\DaroFlix\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _createSuper from\"D:\\\\Documents\\\\React\\\\DaroFlix\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import _inherits from\"D:\\\\Documents\\\\React\\\\DaroFlix\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React from\"react\";import SearchPresenter from\"./SearchPresenter\";import{movieApi,tvApi}from\"../../api\";import{Redirect}from\"react-router\";var _default=/*#__PURE__*/function(_React$Component){_inherits(_default,_React$Component);var _super=_createSuper(_default);function _default(){var _this;_classCallCheck(this,_default);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={movieResults:null,tvResults:null,searchTerm:\"\",error:null,loading:false};_this.handleSubmit=function(event){event.preventDefault();var searchTerm=_this.state.searchTerm;if(searchTerm!==\"\"){_this.searchByTerm(searchTerm);_this.props.history.push(\"/search?query=\".concat(searchTerm));}};_this.updateTerm=function(event){var value=event.target.value;_this.setState({searchTerm:value});};_this.searchByTerm=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(query){var movieResults,tvResults,_yield$movieApi$searc,_yield$tvApi$search;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_this.setState({loading:true});movieResults=null;tvResults=null;//   console.log(`query:${query}`);\n// query 값이 null이면 , null 값을 반환해서 검색 초기상태가 되게 만들기 위한 로직\n// movieResults = [] 로 초기화를 하면 presenter에서 있는걸로 인식을해서\n// data를 가져오지 못한걸로 판단해서 메세지를 띄운다.\nif(!query){_context.next=13;break;}_context.next=7;return movieApi.search(query);case 7:_yield$movieApi$searc=_context.sent;movieResults=_yield$movieApi$searc.data.results;_context.next=11;return tvApi.search(query);case 11:_yield$tvApi$search=_context.sent;tvResults=_yield$tvApi$search.data.results;case 13:_this.setState({movieResults:movieResults,tvResults:tvResults});_context.next=19;break;case 16:_context.prev=16;_context.t0=_context[\"catch\"](0);_this.setState({error:\"Can't find results\"});case 19:_context.prev=19;_this.setState({loading:false});return _context.finish(19);case 22:case\"end\":return _context.stop();}}},_callee,null,[[0,16,19,22]]);}));return function(_x){return _ref.apply(this,arguments);};}();return _this;}_createClass(_default,[{key:\"queryCheck\",value:function queryCheck(){var search=this.props.location.search;var params=new URLSearchParams(search);var query=params.get(\"query\");//   console.log(`query: ${query}`);\nif(query===null){// 현재 query가 아무값도 없을때 ! searchTerm 초기화시켜주고 리렌더링 그리고 url 이동!\nthis.setState({searchTerm:\"\"});this.props.history.push(\"/search\");}else{this.setState({searchTerm:query});}this.searchByTerm(query);}},{key:\"componentDidMount\",value:function componentDidMount(){this.queryCheck();}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){var prevSearch=prevProps.location.search;var nowSearch=this.props.location.search;// console.log(prevSearch, nowSearch);\nif(prevSearch!==nowSearch){this.queryCheck();}}},{key:\"render\",value:function render(){var _this$state=this.state,movieResults=_this$state.movieResults,tvResults=_this$state.tvResults,searchTerm=_this$state.searchTerm,error=_this$state.error,loading=_this$state.loading;return/*#__PURE__*/React.createElement(SearchPresenter,{movieResults:movieResults,tvResults:tvResults,searchTerm:searchTerm,error:error,loading:loading,handleSubmit:this.handleSubmit,updateTerm:this.updateTerm});}}]);return _default;}(React.Component);export{_default as default};","map":{"version":3,"sources":["D:/Documents/React/DaroFlix/src/Routes/Search/SearchContainer.js"],"names":["React","SearchPresenter","movieApi","tvApi","Redirect","state","movieResults","tvResults","searchTerm","error","loading","handleSubmit","event","preventDefault","searchByTerm","props","history","push","updateTerm","value","target","setState","query","search","data","results","location","params","URLSearchParams","get","queryCheck","prevProps","prevSearch","nowSearch","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport SearchPresenter from \"./SearchPresenter\";\r\nimport { movieApi, tvApi } from \"../../api\";\r\nimport { Redirect } from \"react-router\";\r\n\r\nexport default class extends React.Component {\r\n  state = {\r\n    movieResults: null,\r\n    tvResults: null,\r\n    searchTerm: \"\",\r\n    error: null,\r\n    loading: false,\r\n  };\r\n\r\n  handleSubmit = (event) => {\r\n    event.preventDefault();\r\n    const { searchTerm } = this.state;\r\n    if (searchTerm !== \"\") {\r\n      this.searchByTerm(searchTerm);\r\n      this.props.history.push(`/search?query=${searchTerm}`);\r\n    }\r\n  };\r\n  updateTerm = (event) => {\r\n    const {\r\n      target: { value },\r\n    } = event;\r\n    this.setState({\r\n      searchTerm: value,\r\n    });\r\n  };\r\n\r\n  searchByTerm = async (query) => {\r\n    try {\r\n      this.setState({ loading: true });\r\n      let movieResults = null;\r\n      let tvResults = null;\r\n      //   console.log(`query:${query}`);\r\n      // query 값이 null이면 , null 값을 반환해서 검색 초기상태가 되게 만들기 위한 로직\r\n      // movieResults = [] 로 초기화를 하면 presenter에서 있는걸로 인식을해서\r\n      // data를 가져오지 못한걸로 판단해서 메세지를 띄운다.\r\n      if (query) {\r\n        ({\r\n          data: { results: movieResults },\r\n        } = await movieApi.search(query));\r\n        ({\r\n          data: { results: tvResults },\r\n        } = await tvApi.search(query));\r\n      }\r\n      this.setState({\r\n        movieResults,\r\n        tvResults,\r\n      });\r\n    } catch {\r\n      this.setState({\r\n        error: \"Can't find results\",\r\n      });\r\n    } finally {\r\n      this.setState({\r\n        loading: false,\r\n      });\r\n    }\r\n  };\r\n  queryCheck() {\r\n    const {\r\n      location: { search },\r\n    } = this.props;\r\n    const params = new URLSearchParams(search);\r\n    const query = params.get(\"query\");\r\n    //   console.log(`query: ${query}`);\r\n    if (query === null) {\r\n      // 현재 query가 아무값도 없을때 ! searchTerm 초기화시켜주고 리렌더링 그리고 url 이동!\r\n      this.setState({ searchTerm: \"\" });\r\n      this.props.history.push(\"/search\");\r\n    } else {\r\n      this.setState({ searchTerm: query });\r\n    }\r\n    this.searchByTerm(query);\r\n  }\r\n  componentDidMount() {\r\n    this.queryCheck();\r\n  }\r\n  componentDidUpdate(prevProps) {\r\n    const {\r\n      location: { search: prevSearch },\r\n    } = prevProps;\r\n    const {\r\n      location: { search: nowSearch },\r\n    } = this.props;\r\n    // console.log(prevSearch, nowSearch);\r\n\r\n    if (prevSearch !== nowSearch) {\r\n      this.queryCheck();\r\n    }\r\n  }\r\n  render() {\r\n    const { movieResults, tvResults, searchTerm, error, loading } = this.state;\r\n    return (\r\n      <SearchPresenter\r\n        movieResults={movieResults}\r\n        tvResults={tvResults}\r\n        searchTerm={searchTerm}\r\n        error={error}\r\n        loading={loading}\r\n        handleSubmit={this.handleSubmit}\r\n        updateTerm={this.updateTerm}\r\n      />\r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}